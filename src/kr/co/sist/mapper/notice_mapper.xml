<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.sist.notice">

	<resultMap type="kr.co.sist.domain.NoticeList" id="NoticeResult">
		<result column="notice_no" property="notice_no"/>
		<result column="title" property="title"/>
		<result column="admin_id" property="admin_id"/>
		<result column="inputdate" property="inputdate"/>
		<result column="view_count" property="view_count"/>
	</resultMap>
	
	<resultMap type="kr.co.sist.domain.NoticeDetail" id="NoticeDetail">
		<result column="title" property="title"/>
		<result column="body" property="body"/>
		<result column="admin_id" property="admin_id"/>
		<result column="inputdate" property="inputdate"/>
	</resultMap>

	<select id="SelectNoticeList" parameterType="kr.co.sist.vo.SearchNoticeVO" resultMap="NoticeResult">
		select notice_no, admin_id, title, to_char(inputdate, 'yy.mm.dd') inputdate, view_count
		from
		(
		select rownum r_num, notice_no, admin_id, title, inputdate, view_count
		from
		(select notice_no, admin_id, title, inputdate, view_count
		from notice
		order by inputdate desc)
		)
		where r_num between #{startNum} and #{endNum}
	</select>
	<select id="selectTotalPageCount" resultType="int">
		select count(*) cnt
		from notice
	</select>
	<select id="selectNoticeDetail" parameterType="int" resultMap="NoticeDetail">
		select admin_id, title, body, to_char(inputdate, 'yyyy.mm.dd hh24:mi') inputdate 
		from notice 
		where notice_no = #{notice_no} 
	</select> 
	<update id="updateNoticeDetail" parameterType="kr.co.sist.vo.ModifyNoticeVO">
		update notice 
		set title=#{title}, body=#{body} 
		where notice_no = #{num} 
	</update>
	<insert id="insertNotice" parameterType="kr.co.sist.vo.WriteNoticeVO">
		insert into notice(notice_no, admin_id, title, body)
		values(seq_notice_no.nextval, #{admin_id}, #{title}, #{body})
	</insert>
	<delete id="deleteNotice" parameterType="int">
		delete from notice
		where notice_no = #{notice_no}
	</delete>
</mapper>